# 绝区零俄罗斯方块《妄想天使训练中》数值机制

部分数值仅适用于当前能力值分配，欢迎补充

---
# 方块生成
方块在10列的第3-6列生成，这些列的第20行受到遮挡时游戏结束，其余列超出20行游戏结束

# 基础消行
每行分值$100+20(L-1)$分，其中$L$为**消行后所处**等级

> 例：对于一个在Lv.4进行的4消，消除完成后进入Lv.5，则每行分值为$100+20\times(5-1)=180$，即该4消基础分值为560分

# 等级划分
|总行数|等级|该等级需消除行数|
|---|---|---|
|1-5|Lv.1|5行|
|6-13|Lv.2|8行|
|14-24|Lv.3|11行|
|25-38|Lv.4|14行|
|39-55|Lv.5|17行|
|56-75|Lv.6|20行|
|76-95|Lv.7|20行|
|96-115|Lv.8|20行|
|116-135|Lv.9|20行|
|136-155|Lv.10|20行|
|156+|Lv.11|-|

# 技能消行
- 1技能：立即将持有方块换为一个I块，无加成
- 2技能：在左侧第一列立刻填满20行，每行基础分值为$700+140(x-1)$，其中$x$为**消行后所处的等级**
> 2技能**不计算高度加成**，但**计算幸运加成**，即持有幸运方块进行消除按消除高度计算幸运加成
> 
> 2技能消除完成后如果等级提升，下落速度依然为消除前的等级对应的下落速度
- 3技能：立即将持有方块更换为同类型幸运方块
- 终结技：立即清空场地，场地上每一个方格基础分值10分，该技能消除的行数不计入等级
> 终结技计算高度加成，不计算幸运加成

# 加分规则
## 多消加成
对Lv.6“舞蹈”能力，固定值$500\%$

出现概率由“舞蹈”等级决定

## 高度加成
对Lv.6“节奏”能力，从指示线（第5行）开始，加成百分值符合以下分段函数：

$$

P(x)=
\begin{cases}
	100+30x,&1\le x\le 10\\
	540+40(x−11),&11\le x\le 15
\end{cases} 

$$

其中$x$为场地最高高度

## 暴击加成
对Lv.8“声乐”能力，固定值$440\%$

出现概率由“声乐”等级决定

## 幸运方块
对Lv.4“体能”能力：

$$

P(x)=(100+80x)\%

$$

其中$x$为使用幸运方块消除的总高度

**使用幸运方块消除的行数不计入等级增加**

出现概率由“体能”等级决定

# 理论最高消除
## 无助力，单次
> 前置条件：幸运I块，以以上能力等级为例

*10级*

Tetris: 1120分
- 高度加成：700%
- 暴击加成：440%
- 多消加成：500%
- 幸运方块：420%

总计：724,416分

## 有助力，单次
> 前置条件：技能3+技能2
>
> 最多一次消除19行
>
> 能力加点：\[6,6,6,6\]

*10级->11级*：

19消: 39900
- 幸运方块：2000%
- 多消加成：500%
- 暴击加成：400%

总计：15,960,000分

---

## **有助力，单局最佳序列**
`1次20行终结技（177个填充格） -> 17消 -> 18消 -> 6次19消 -> 1次普通4消（最高高度加成） -> 2次幸运I块4消（3技能，最高高度加成） -> 19消`

该序列在最开始跳过 Lv.2，使用 Lv.3 的 2 技能消除基础分，并在后续的 2 技能消除中均进入下一等级。不考虑随机幸运方块，假设每次 2 技能消除后接一个无高度加成的幸运 I 块 4 消清理版面，最多消除 228 行。
### 能力加点：`[8,6,6,4]`

1.  **终结技得分**：
	\( 177 \times 10 \times (7 \times 4.4 \times 5) = 272580 \)

2.  **17消 + 4消（Lv.3）**：
	\( 17 \times (700 + 140 \times (3 - 1)) \times (4.4 \times 5 \times (100 + 80 \times 17) / 100) + 4 \times (100 + 20 \times (3 - 1)) \times (4.4 \times 5 \times (100 + 80 \times 4) / 100) = 5351192 + 51744 = 5402936 \)

3.  **18消 + 4消（Lv.4）**：
	\( 18 \times (700 + 140 \times (4 - 1)) \times (4.4 \times 5 \times (100 + 80 \times 18) / 100) + 4 \times (100 + 20 \times (4 - 1)) \times (4.4 \times 5 \times (100 + 80 \times 4) / 100) = 6830208 + 59136 = 6889344 \)

4.  **6次 (19消 + 4消)**：
	\[
	\sum_{i=5}^{10} \left[ 19 \times (700 + 140 \times (i - 1)) \times (4.4 \times 5 \times (100 + 80 \times 19) / 100) + 4 \times (100 + 20 \times (i - 1)) \times (4.4 \times 5 \times (100 + 80 \times 4) / 100) \right] = 65923704
	\]

5.  **1次普通4消**：
	\( 4 \times (100 + 20 \times (10 - 1)) \times (7 \times 4.4 \times 5) = 172480 \)

6.  **2次幸运I块4消**：
	\( 2 \times 4 \times (100 + 20 \times (10 - 1)) \times (7 \times 4.4 \times 5 \times (100 + 80 \times 4) / 100) = 1448832 \)

7.  **19消（Lv.11）**：
	\( 19 \times (700 + 140 \times (11 - 1)) \times (4.4 \times 5 \times (100 + 80 \times 19) / 100) = 14220360 \)

**总计**：\( 94330236 \)

*期望修正*：

若假设随机幸运方块出现概率 5%，则单局将约有 23 块幸运方块，平均每个幸运方块消除 3 行。
- 由于等级不均匀，根据等级递进与基础消行得分，计算得到期望约为 \( 208 \) 分/行。
- 假设游玩时任一时刻所处的高度在 1-20 行中均匀分布，根据高度加成分段函数得到高度加成期望约为 \( 383.33\% \)。

则理论总分约为：
\[
23 \times 3 \times 208 \times (4.4 \times 5 \times (100 + 80 \times 3) / 100 \times 3.8333) + 94330236 \approx 98441854
\]

### **能力加点：`[6,6,6,6]`**

**得分计算**：
1.  **终结技得分**：
	\( 177 \times 10 \times (7 \times 5 \times 4) = 247800 \)

2.  **17消+4消（Lv.3）**：
	\( 17 \times (700 + 140 \times (3 - 1)) \times (5 \times 4 \times (100 \times (17 + 1) / 100)) + 4 \times (100 + 20 \times (3 - 1)) \times (5 \times 4 \times (100 \times (4 + 1) / 100)) = 5997600 + 56000 = 6053600 \)

3.  **18消+4消（Lv.4）**：
	\( 18 \times (700 + 140 \times (4 - 1)) \times (5 \times 4 \times (100 \times (18 + 1) / 100)) + 4 \times (100 + 20 \times (4 - 1)) \times (5 \times 4 \times (100 \times (4 + 1) / 100)) = 7660800 + 64000 = 7724800 \)

4.  **6次(19消+4消)**：
	\[
	\sum_{i=5}^{10} \left[ 19 \times (700 + 140 \times (i - 1)) \times (5 \times 4 \times (100 \times (19 + 1) / 100)) + 4 \times (100 + 20 \times (i - 1)) \times (5 \times 4 \times (100 \times (4 + 1) / 100)) \right] = 73968000
	\]

5.  **1次普通4消**：
	\( 4 \times (100 + 20 \times (10 - 1)) \times (7 \times 5 \times 4) = 156800 \)

6.  **2次幸运I块4消**：
	\( 2 \times 4 \times (100 + 20 \times (10 - 1)) \times (7 \times 5 \times 4 \times (100 \times (4 + 1) / 100)) = 1568000 \)

7.  **19消（Lv.11）**：
	\( 19 \times (700 + 140 \times (11 - 1)) \times (5 \times 4 \times (100 \times (19 + 1) / 100)) = 15960000 \)

**总计**：\( 105,679,000 \)

*期望修正*：

若假设随机幸运方块出现概率 5%，则单局将约有 23 块幸运方块，平均每个幸运方块消除 3 行。

- 由于等级不均匀，根据等级递进与基础消行得分，计算得到期望约为 \( 208 \) 分/行。
- 假设游玩时任一时刻所处的高度在 1-20 行中均匀分布，根据高度加成分段函数得到高度加成期望约为 \( 383.33\% \)。

则理论总分约为：
\[
23 \times 3 \times 208 \times (4 \times 5 \times 4 \times 3.8333) + 105,679,000 \approx 110,080,242
\]
